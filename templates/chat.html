<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="UTF-8">
        <title>ALICE CHATBOT</title>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
        <style type="text/css">
            .fixed-panel {
                min-height: 400px;
                max-height: 400px;
                overflow-y: scroll;
            }
            .media-list {
                overflow: auto;
            }
            .axis {
                font: 10px sans-serif;
            }       
            .axis path,
            .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
            }
            table {
                border-collapse: collapse;
                width: 100%;
            }
            
            th, td {
                text-align: left;
                padding: 8px;
            }
            
            tr:nth-child(even) {background-color: #f2f2f2;}
        
        </style>
    </head>
    <body>
        <div class="container">
            <div class="row">
                <h1 class="text-center">ALICE CHATBOT</h1>

                <div class="col-md-4">
                    <div id="chatPanel" class="panel panel-info">
                        <div class="panel-heading">
                            <strong><span class="glyphicon glyphicon-list"></span> Chat History</strong>
                        </div>
                        <div class="panel-body fixed-panel">
                            <ul class="media-list">
                            </ul>
                        </div>
                        <div class="panel-footer">
                            <form method="post" id="chatbot-form">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Enter Message" name="messageText" id="messageText" autofocus/>
                                    <span class="input-group-btn">
                                        <button class="btn btn-info" type="button" id="chatbot-form-btn">SEND <span class="glyphicon glyphicon-send"></span></button>
                                    </span>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-8">
                    <h2>Word Frequency</h2>
                    <div id="theSvg"></div>
                    <h2>LDA results</h2>
                    <table>
                        <tr>
                          <th>first</th>
                          <th>second</th>
                          <th>third</th>
                          <th>fourth</th>
                          <th>fifth</th>

                        </tr>
                        <tr>
                          <td>decentralized</td>
                          <td>discussion</td>
                          <td>works</td>
                          <td>worldwide</td>
                          <td>ecosystem</td>
                        </tr>
                        <tr>
                            <td>decentralized</td>
                            <td>discussion</td>
                            <td>works</td>
                            <td>worldwide</td>
                            <td>ecosystem</td>
                        </tr>
                        <tr>
                            <td>decentralized</td>
                            <td>discussion</td>
                            <td>works</td>
                            <td>worldwide</td>
                            <td>ecosystem</td>
                        </tr>
                        <tr>
                            <td>decentralized</td>
                            <td>discussion</td>
                            <td>works</td>
                            <td>worldwide</td>
                            <td>ecosystem</td>
                        </tr>
                      </table>
                </div>
            </div>
        </div>

        <script src="http://code.jquery.com/jquery-1.12.4.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script>
        $(function() {
            $('#chatbot-form-btn').click(function(e) {
                e.preventDefault();
                $('#chatbot-form').submit();
            });

            $('#chatbot-form').submit(function(e) {
                e.preventDefault();

                var message = $('#messageText').val();
                $(".media-list").append('<li class="media"><div class="media-body"><div class="media"><div class="media-body">' + message + '<hr/></div></div></div></li>');

                console.log(message)
                
                $.ajax({
                    type: "POST",
                    url: "/ask",
                    data: {'message':message},
                    success: function(response) {
                        $('#messageText').val('');
                        var answer = response.answer;
                        const chatPanel = document.getElementById("chatPanel");
                        $(".media-list").append('<li class="media"><div class="media-body"><div class="media"><div class="media-body">' + answer + '<hr/></div></div></div></li>');

                    },
                    error: function(error) {
                        console.log(error);
                    }
                });
            });
        });
        </script>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        
        <script>
        
        var margin = {top: 20, right: 20, bottom: 70, left: 40},
            width = 600 - margin.left - margin.right,
            height = 300 - margin.top - margin.bottom;
        
        // Parse the date / time
       
        
        var x = d3.scale.ordinal().rangeRoundBands([0, width], .05);
        
        var y = d3.scale.linear().range([height, 0]);
        
        var xAxis = d3.svg.axis()
            .scale(x)
            .orient("bottom")
            .ticks(10);
        
        var yAxis = d3.svg.axis()
            .scale(y)
            .orient("left")
            .ticks(10);
        
        var svg = d3.select("#theSvg").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
          .append("g")
            .attr("transform", 
                  "translate(" + margin.left + "," + margin.top + ")");
        
        var data = [
        {date:'bitcoin', value:56},
        {date:'peer', value:8},
        {date:'news', value:7},
        {date:'cuurency', value:7}
        ]
        
            data.forEach(function(d) {
                d.date = d.date;
                d.value = +d.value;
            });
            
          x.domain(data.map(function(d) { return d.date; }));
          y.domain([0, d3.max(data, function(d) { return d.value; })]);
        
          svg.append("g")
              .attr("class", "x axis")
              .attr("transform", "translate(0," + height + ")")
              .call(xAxis)
            .selectAll("text")
              .style("text-anchor", "end")
              .attr("dx", "-.8em")
              .attr("dy", "-.55em")
              .attr("transform", "rotate(-90)" );
        
          svg.append("g")
              .attr("class", "y axis")
              .call(yAxis)
            .append("text")
              .attr("transform", "rotate(-90)")
              .attr("y", 6)
              .attr("dy", ".71em")
              .style("text-anchor", "end")
              .text("Value ($)");
        
          svg.selectAll("bar")
              .data(data)
            .enter().append("rect")
              .style("fill", "steelblue")
              .attr("x", function(d) { return x(d.date); })
              .attr("width", x.rangeBand())
              .attr("y", function(d) { return y(d.value); })
              .attr("height", function(d) { return height - y(d.value); });
        
        
        
        </script>
        
    </body>
</html>
